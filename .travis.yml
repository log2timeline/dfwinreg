sudo: required
dist: trusty
language: python
python:
  - "2.7"
  - "3.4"
before_install:
  - if test `uname -s` = 'Linux'; then sudo add-apt-repository ppa:gift/dev -y && sudo apt-get update -q && sudo apt-get install libregf-python python-construct python-coverage python-coveralls python-docopt python-six libregf-python3 python3-construct python3-six; fi
script:
  - if test `uname -s` = 'Linux' && test `python -V 2>&1 | sed 's/Python \([0-9][0-9]*\)[.][0-9][0-9]*[.][0-9][0-9]*.*/\1/'` = '2'; then coverage run --source=dfwinreg --omit="*_test*,*__init__*,*test_lib*" ./run_tests.py; else ./run_tests.py; fi
  - ./setup.py build
  - ./setup.py sdist
  - ./setup.py bdist
after_success:
  - if test `uname -s` = 'Linux' && test `python -V 2>&1 | sed 's/Python \([0-9][0-9]*\)[.][0-9][0-9]*[.][0-9][0-9]*.*/\1/'` = '2'; then coveralls --verbose; fi
